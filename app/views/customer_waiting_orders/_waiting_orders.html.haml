-# Required variables: "waiting_orders" => list of waiting_orders

%table.customer-waiting-orders
  %thead.title
    %tr
      %th{:colspan => (current_user.has_role?('edit-orders') ? 5 : 4)}
        = glossary_term('Waiting Orders')
        = "(#{waiting_orders.count})"
  %thead
    %tr
      %th Publication
      %th # Copies
      %th Date
      %th Comments
      - if current_user.has_role? 'edit-orders'
        %th
  %tbody
    - waiting_orders.each do |waiting_order|
      %tr
        %td.publication= waiting_order.publication.name
        %td.num_copies= waiting_order.num_copies
        %td.request_date= waiting_order.request_date
        %td.comments= waiting_order.comments
        - if current_user.has_role? 'edit-orders'
          %td.actions
            = link_to 'Edit', edit_customer_waiting_order_path(@customer, waiting_order)
            = button_to 'Delete', customer_waiting_order_path(@customer, waiting_order), data: { :confirm => 'Are you sure you want to remove this Waiting Order?' }, :method => :delete
            = button_to 'Convert to Standing Order', convert_to_standing_order_customer_waiting_order_path(@customer, waiting_order), data: { :confirm => 'Are you sure you want this to become a Standing Order?' }, :method => :post
    - if current_user.has_role? 'edit-orders'
      %tr
        %td.add{:colspan => current_user.has_role?('edit-orders') && 5 || 4}
          = link_to 'Add New Waiting Order', new_customer_waiting_order_path(@customer)
